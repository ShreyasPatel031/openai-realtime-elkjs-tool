<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Atelier</title>
    <meta name="description" content="Atelier - Architecture Design Tool" />
    <meta name="author" content="Atelier" />
    <link rel="icon" href="/assets/canvas/atelier.png" />
    <link rel="shortcut icon" href="/assets/canvas/atelier.png" type="image/png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Content Security Policy for embedded environments -->
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://www.gstatic.com https://apis.google.com https://connect.facebook.net; frame-src 'self' https://*.firebaseapp.com https://accounts.google.com; object-src 'none'; base-uri 'self';">
    <link rel="stylesheet" href="/base.css" />
    <base href="/" />
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <!-- head -->
  </head>
  <body>
    <!-- Framer Auth compatibility script (must be loaded first) -->
    <script src="/framer-auth.js"></script>
    
    <!-- Additional debugging for blocked resources -->
    <script>
      // Early debugging setup
      window.debugBlockedResources = true;
      
      // Monitor Firebase initialization attempts
      if (typeof window !== 'undefined') {
        const originalConsoleError = console.error;
        console.error = function(...args) {
          // Check for Firebase-related errors
          const message = args.join(' ');
          if (message.includes('Firebase') || message.includes('firebase') || message.includes('googleapis')) {
            console.log('🔥 [FIREBASE-DEBUG]', 'Firebase error detected:', ...args);
          }
          return originalConsoleError.apply(this, args);
        };
        
        // Monitor script loading
        const observer = new MutationObserver((mutations) => {
          mutations.forEach((mutation) => {
            mutation.addedNodes.forEach((node) => {
              if (node.tagName === 'SCRIPT') {
                console.log('📜 [SCRIPT-DEBUG]', 'Script added:', node.src || 'inline script');
                
                node.addEventListener('error', (e) => {
                  console.log('❌ [SCRIPT-ERROR]', 'Script failed to load:', node.src, e);
                });
                
                node.addEventListener('load', (e) => {
                  console.log('✅ [SCRIPT-SUCCESS]', 'Script loaded successfully:', node.src);
                });
              }
            });
          });
        });
        
        observer.observe(document.head, { childList: true, subtree: true });
        observer.observe(document.body, { childList: true, subtree: true });
      }
    </script>
    
    <div id="root"><!--ssr-outlet--></div>
    <!-- hydration -->
    <script type="module" src="/entry-client.jsx"></script>
  </body>
</html>
